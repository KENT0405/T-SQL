DROP TABLE IF EXISTS tb_daily_tran
GO

CREATE TABLE tb_daily_tran
(
	tran_date DATE,
	server_code VARCHAR(10),
	amt DECIMAL(18,6)
)
GO

INSERT INTO tb_daily_tran VALUES ('2022-11-01','SG',2)
INSERT INTO tb_daily_tran VALUES ('2022-11-01','IM',2)
INSERT INTO tb_daily_tran VALUES ('2022-11-01','SGPRO',2)
INSERT INTO tb_daily_tran VALUES ('2022-11-01','IM',2)
INSERT INTO tb_daily_tran VALUES ('2022-11-01','IC',2)
INSERT INTO tb_daily_tran VALUES ('2022-11-01','PGR',2)

INSERT INTO tb_daily_tran
SELECT '2022-11-02',server_code,3
FROM tb_daily_tran
WHERE tran_date = '2022-11-01'

INSERT INTO tb_daily_tran
SELECT '2022-11-03',server_code,4
FROM tb_daily_tran
WHERE tran_date = '2022-11-01'

INSERT INTO tb_daily_tran
SELECT '2022-11-04',server_code,5
FROM tb_daily_tran
WHERE tran_date = '2022-11-01'

INSERT INTO tb_daily_tran
SELECT '2022-11-05',server_code,6
FROM tb_daily_tran
WHERE tran_date = '2022-11-01'
GO

SELECT *
FROM [tb_daily_tran] AS t
PIVOT
(
	SUM(amt)
	FOR server_code IN ([SG],[IM],[SGPRO],[IC],[PGR])
) AS pvt


SELECT *
FROM [tb_daily_tran] AS t
PIVOT
(
	SUM(amt)
	FOR tran_date IN ([2022-11-01],[2022-11-02],[2022-11-03],[2022-11-04],[2022-11-05])
) AS pvt

/*
		tran_date  	SG			IM			SGPRO		IC			PGR
1		2022-11-01	2.000000	4.000000	2.000000	2.000000	2.000000
2		2022-11-02	3.000000	6.000000	3.000000	3.000000	3.000000
3		2022-11-03	4.000000	8.000000	4.000000	4.000000	4.000000
4		2022-11-04	5.000000	10.000000	5.000000	5.000000	5.000000
5		2022-11-05	6.000000	12.000000	6.000000	6.000000	6.000000

		server_code		2022-11-01		2022-11-02		2022-11-03		2022-11-04		2022-11-05
1		IC				2.000000		3.000000		4.000000		5.000000		6.000000
2		IM				4.000000		6.000000		8.000000		10.000000		12.000000
3		PGR				2.000000		3.000000		4.000000		5.000000		6.000000
4		SG				2.000000		3.000000		4.000000		5.000000		6.000000
5		SGPRO			2.000000		3.000000		4.000000		5.000000		6.000000
*/